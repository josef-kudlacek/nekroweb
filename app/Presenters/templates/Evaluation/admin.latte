{block content}
    <div class="container">
        <h1 n:block="title">Moje hodnocení letošních hodin</h1>
        <div class="text-center">
            <a class="btn btn-info" href="{link Evaluation:create}">Přidat hodnocení</a>
            <a class="btn btn-primary" href="{link Evaluation:show}">Zobrazit všechna hodnocení</a>
        </div>
        {if $evaluations}
            {if $evaluationStats->StarsCount != 0}
                <div class="container eval-stats">
                    <div class="row">
                        <div class="col">
                            <div class="rating-block text-center">
                                <h3>Průměrné hodnocení</h3>
                                <h1>{$evaluationStats->StarsAverage} / 5</h1>
                                {for $counter = 1; $counter <= 5; $counter++}
                                    {if $evaluationStats->StarsAverage > $counter -1}
                                        {if $evaluationStats->StarsAverage >= $counter - 0.75 && $evaluationStats->StarsAverage <= $counter - 0.25}
                                            <button class="btn btn-link button-star" type="button">
                                                <i class="fa fa-star-half-full ranking-star"></i>
                                            </button>
                                        {else}
                                            <button class="btn btn-primary button-star" type="button">
                                                <i class="fa fa-star-o ranking-star"></i>
                                            </button>
                                        {/if}
                                    {else}
                                         <button class="btn btn-link button-star" type="button">
                                            <i class="fa fa-star-o ranking-star"></i>
                                        </button>
                                    {/if}
                                {/for}
                            </div>
                        </div>
                        <div class="col-5">
                            <h3>Přehled hodnocení</h3>
                            {for $counter = 5; $counter > 0; $counter--}
                                <div class="row no-gutters">
                                    <div class="col-10">
                                        <div class="pull-rating">
                                            <span>{$counter}&nbsp;</span>
                                            <i class="fa fa-star"></i>
                                            <div class="pull-rating-bar">
                                                <div class="rating-progress">
                                                    <div class="progress">
                                                        {switch $counter}
                                                        {case 5}
                                                            <div class="progress-bar bg-{$counter|houseType}"
                                                                aria-valuenow="{$evaluationStats->Stars5}" aria-valuemin="0"
                                                                aria-valuemax="{$evaluationStats->StarsCount}" style="width: {countPercentStars($evaluationStats->Stars5, $evaluationStats->StarsCount)}%;">
                                                            </div>
                                                        {case 4}
                                                            <div class="progress-bar bg-{$counter|houseType}"
                                                                aria-valuenow="{$evaluationStats->Stars4}" aria-valuemin="0"
                                                                aria-valuemax="{$evaluationStats->StarsCount}" style="width: {countPercentStars($evaluationStats->Stars4, $evaluationStats->StarsCount)}%;">
                                                            </div>
                                                        {case 3}
                                                            <div class="progress-bar bg-{$counter|houseType}"
                                                                aria-valuenow="{$evaluationStats->Stars3}" aria-valuemin="0"
                                                                aria-valuemax="{$evaluationStats->StarsCount}" style="width: {countPercentStars($evaluationStats->Stars3, $evaluationStats->StarsCount)}%;">
                                                            </div>
                                                        {case 2}
                                                            <div class="progress-bar bg-{$counter|houseType}"
                                                                aria-valuenow="{$evaluationStats->Stars2}" aria-valuemin="0"
                                                                aria-valuemax="{$evaluationStats->StarsCount}" style="width: {countPercentStars($evaluationStats->Stars2, $evaluationStats->StarsCount)}%;">
                                                            </div>
                                                        {default}
                                                            <div class="progress-bar bg-{$counter|houseType}"
                                                                aria-valuenow="{$evaluationStats->Stars1}" aria-valuemin="0"
                                                                aria-valuemax="{$evaluationStats->StarsCount}" style="width: {countPercentStars($evaluationStats->Stars1, $evaluationStats->StarsCount)}%;">
                                                            </div>
                                                        {/switch}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="pull-rating-right">
                                                {switch $counter}
                                                {case 5}
                                                    <span>{$evaluationStats->Stars5}x</span>
                                                {case 4}
                                                    <span>{$evaluationStats->Stars4}x</span>
                                                {case 3}
                                                    <span>{$evaluationStats->Stars3}x</span>
                                                {case 2}
                                                    <span>{$evaluationStats->Stars2}x</span>
                                                {default}
                                                    <span>{$evaluationStats->Stars1}x</span>
                                                {/switch}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {/for}
                        </div>
                    </div>
                </div>
            {else}
                <i>Nenalezen žádný záznam.</i>
            {/if}
            {foreach $evaluations as $evaluation}
                <div class="row rating-row">
                    <div class="col-3">
                        <div class="review-block-name">
                            Školní rok: {$evaluation->YearFrom}{if $evaluation->YearTo}/{$evaluation->YearTo}{/if}<br />
                            <a href="https://bradavice.eu//ukaz.php?name={urlencode($evaluation->UserName|encodeToWin1250)}" target="_blank"
                            class="text-{$evaluation->HouseId|houseType}">{$evaluation->UserName}, {$evaluation->ClassName}</a>
                        </div>
                        <div class="review-block-date">
                            {$evaluation->Date|date:'%d. %m. %Y'}
                        </div>
                        <div class="review-block-stars">
                            {for $counter = 1; $counter < 6; $counter++}
                                {if $evaluation->StarsCount >= $counter}
                                    <button class="btn btn-primary button-star btn-sm" type="button">
                                        <i class="fa fa-star-o ranking-star"></i>
                                    </button>
                                {else}
                                    <button class="btn btn-link button-star btn-sm" type="button">
                                        <i class="fa fa-star-o ranking-star"></i>
                                    </button>
                                {/if}
                            {/for}
                        </div>
                    </div>
                    <div class="col">
                        <div class="review-block-name">
                            {$evaluation->LessonNumber}. hodina ({$evaluation->LessonName})
                        </div>
                        <div class="review-block-evaluation">
                            {$evaluation->Description}
                            <br />
                            <a href="{link Evaluation:edit $evaluation->Id}" class="btn btn-warning btn-sm"
                               role="button">Upravit hodnocení</a>
                            <a href="{link Evaluation:delete $evaluation->Id}" class="btn btn-danger btn-sm"
                               role="button">Smazat hodnocení</a>
                        </div>
                    </div>
                </div>
            {/foreach}
        {else}
            <i>Nenalezen žádný záznam.</i>
        {/if}
    </div>
{/block}